<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Apprentissage automatique interprétable – counterfactual</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../09-local_model_agnostic_methods/09.4-anchors.html" rel="next">
<link href="../09-local_model_agnostic_methods/09.2-lime.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../09-local_model_agnostic_methods/index.html">9 - Méthodes locales indépendantes du modèle</a></li><li class="breadcrumb-item"><a href="../09-local_model_agnostic_methods/09.3-counterfactual.html">9.3 - Explications contrefactuelles</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Recherche" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Apprentissage automatique interprétable</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../00-summary/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Résumé</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-preface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1 - Préface de l’auteur</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../02-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2 - Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-introduction/02.1-short_stories.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.1 - Quelques histoires</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-introduction/02.2-ml_definitions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.2 - Qu’est-ce que l’apprentissage automatique ?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-introduction/02.3-terminology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.3 - Terminologie</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../03-Interpretability/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3 - Interprétabilité</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-Interpretability/03.1-importance_of_interpretability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3.1 - Importance de l’Interprétabilité</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-Interpretability/03.2-taxonomy_of_interpretability_methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3.2 - Taxonomie des Méthodes d’Interprétabilité</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-Interpretability/03.3-scope_of_interpretability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3.3 - Portée de l’Interprétabilité</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-Interpretability/03.4-evaluation_of_interpretability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3.4 - Evaluation de l’interprétabilité</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-Interpretability/03.5-properties_of_explanations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3.5 - Propriétés des Explications</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-Interpretability/03.6-human_friendly_explanations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3.6 - Explications conviviales pour l’être humain</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../04-datasets/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4 - Jeux de données</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-datasets/04.1-datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4.1 - Location de vélo (Régression)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-datasets/04.2-datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4.2 - Commentaires indésirables sur YouTube (Classification de Texte)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-datasets/04.3-datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4.3 - Facteurs de Risque du Cancer du Col de l’Uterus (Classification)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../05-interpretable_models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5 - Modèles interprétables</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-interpretable_models/05.1-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5.1 - Régéression linéaire</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-interpretable_models/05.2-logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5.2 - Régéression logistique</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-interpretable_models/05.3-glm-gam-more.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5.3 - GLM, GAM et plus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-interpretable_models/05.4-decision-tree.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5.4 - Arbre de décision</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-interpretable_models/05.5-decision-rules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5.5 - Règles de décision</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-interpretable_models/05.6-rulefit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5.6 - Ajustement des règles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-interpretable_models/05.7-other-interpretable-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5.7 - Autres modèles interprétables</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06-model_agnostic_methods/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6 - Méthodes indépendantes du modèle</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07-example/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7 - Explications basées sur des exemples</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../08-global_model_agnostic_methods/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8 - Méthodes globales indépendantes du modèle</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08-global_model_agnostic_methods/08.1-pdp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.1 - Diagramme de dépendance partielle (PDP)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08-global_model_agnostic_methods/08.2-ale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.2 - Graphique des effets locaux accumulés (ALE)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08-global_model_agnostic_methods/08.3-feature-interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.3 - Interactions avec les fonctionnalités</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08-global_model_agnostic_methods/08.4-functional-decomposition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.4 - Functional Decomposition</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08-global_model_agnostic_methods/08.5-permutation-feature-importance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.5 - Décomposition fonctionnelle</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08-global_model_agnostic_methods/08.6-global-surrogate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.6 - Substitut global</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08-global_model_agnostic_methods/08.7-prototype-criticisms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.7 - Prototypes et critiques</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../09-local_model_agnostic_methods/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9 - Méthodes locales indépendantes du modèle</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09-local_model_agnostic_methods/09.1-ice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9.1 - Attente Conditionnelle Individuelle (<em>Individual Conditional Expectation - ICE</em>)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09-local_model_agnostic_methods/09.2-lime.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9.2 - Substitut local (LIME)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09-local_model_agnostic_methods/09.3-counterfactual.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">9.3 - Explications contrefactuelles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09-local_model_agnostic_methods/09.4-anchors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9.4 - Règles de portée (ancres)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09-local_model_agnostic_methods/09.5-shapley.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9.5 - Valeurs de Shapley</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09-local_model_agnostic_methods/09.6-shap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9.6 - SHAP (SHapley Additive exPlanations)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../10-neuralnet/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10 - Interprétation d'un réseau de neurone</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10-neuralnet/10.1-learned-features.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10.1 - Caractéristiques apprises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10-neuralnet/10.2-pixel-attribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10.2 - Attribution de pixel</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10-neuralnet/10.3-concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10.3 - Détecter les concepts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10-neuralnet/10.4-adversarial-examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10.4 - Exemples adverses</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10-neuralnet/10.5-influential-instances.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10.5 - Instances Influentes</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../11-future/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11 - Un regard dans une boule de cristal</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../11-future/11.1-future-ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11.1 - L’avenir de l’apprentissage automatique</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../11-future/11.2-future-interpretability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11.2 - L’avenir de l’interprétabilité</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../12-contribute/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12 - Contribuer à ce livre</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../13-citation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13 - Citer ce livre</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../14-translations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14 - Traductions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../15-acknowledgements/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15 - Remerciements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Formulaire/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Des remarques ?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../References/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Références</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="4">
    <h2 id="toc-title">Dans cette page</h2>
   
  <ul>
  <li><a href="#explications-contrefactuelles" id="toc-explications-contrefactuelles" class="nav-link active" data-scroll-target="#explications-contrefactuelles">9.3 - Explications contrefactuelles</a>
  <ul>
  <li><a href="#générer-des-explications-contrefactuelles" id="toc-générer-des-explications-contrefactuelles" class="nav-link" data-scroll-target="#générer-des-explications-contrefactuelles">9.3.1 - Générer des explications contrefactuelles</a>
  <ul class="collapse">
  <li><a href="#méthode-de-wachter-et-al." id="toc-méthode-de-wachter-et-al." class="nav-link" data-scroll-target="#méthode-de-wachter-et-al.">9.3.1.1 - Méthode de Wachter et al.</a></li>
  <li><a href="#méthode-de-dandl-et-al." id="toc-méthode-de-dandl-et-al." class="nav-link" data-scroll-target="#méthode-de-dandl-et-al.">9.3.1.2 Méthode de Dandl et al.</a></li>
  </ul></li>
  <li><a href="#exemple" id="toc-exemple" class="nav-link" data-scroll-target="#exemple">9.3.2 - Exemple</a></li>
  <li><a href="#avantages" id="toc-avantages" class="nav-link" data-scroll-target="#avantages">9.3.3 - Avantages</a></li>
  <li><a href="#inconvénients" id="toc-inconvénients" class="nav-link" data-scroll-target="#inconvénients">9.3.4 - Inconvénients</a></li>
  <li><a href="#logiciels-et-alternatives" id="toc-logiciels-et-alternatives" class="nav-link" data-scroll-target="#logiciels-et-alternatives">9.3.5 - Logiciels et alternatives</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../09-local_model_agnostic_methods/index.html">9 - Méthodes locales indépendantes du modèle</a></li><li class="breadcrumb-item"><a href="../09-local_model_agnostic_methods/09.3-counterfactual.html">9.3 - Explications contrefactuelles</a></li></ol></nav>
<div class="quarto-title">
</div>



<div class="quarto-title-meta">

    
  
    <div>
    <div class="quarto-title-meta-heading">Modifié</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">19 février 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<div class="callout callout-style-default callout-warning callout-titled" title="Avertissement">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Avertissement
</div>
</div>
<div class="callout-body-container callout-body">
<p>En cours de traduction.</p>
</div>
</div>
<section id="explications-contrefactuelles" class="level2">
<h2 class="anchored" data-anchor-id="explications-contrefactuelles">9.3 - Explications contrefactuelles</h2>
<p><em>Auteurs : Susanne Dandl et Christoph Molnar</em></p>
<p>Une explication contrefactuelle décrit une situation causale sous la forme : « Si X ne s’était pas produit, Y ne se serait pas produit ». Par exemple : « Si je n’avais pas bu une gorgée de ce café chaud, je ne me serais pas brûlé la langue ». L’événement Y est que je me suis brûlé la langue ; parce que X, c’est que j’ai pris un café chaud. Penser de manière contrefactuelle nécessite d’imaginer une réalité hypothétique qui contredit les faits observés (par exemple, un monde dans lequel je n’ai pas bu de café chaud), d’où le nom de « contrefactuel ». La capacité de penser de manière contrefactuelle nous rend, les humains, si intelligents par rapport aux autres animaux.</p>
<p>Dans l’apprentissage automatique interprétable, des explications contrefactuelles peuvent être utilisées pour expliquer les prédictions d’instances individuelles. L’« événement » est le résultat prédit d’une instance, les « causes » sont les valeurs de caractéristiques particulières de cette instance qui ont été entrées dans le modèle et « ont provoqué » une certaine prédiction. Affichée sous forme de graphique, la relation entre les entrées et la prédiction est très simple : les valeurs des caractéristiques provoquent la prédiction.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/graph.jpg" class="img-fluid figure-img" data-align="center"></p>
<figcaption>Les relations causales entre les entrées d’un modèle d’apprentissage automatique et les prédictions, lorsque le modèle est simplement vu comme une boîte noire. Les entrées provoquent la prédiction (ne reflétant pas nécessairement la relation causale réelle des données).</figcaption>
</figure>
</div>
<p>Même si en réalité la relation entre les entrées et le résultat à prédire n’est pas causale, nous pouvons considérer les entrées d’un modèle comme la cause de la prédiction.</p>
<p>Compte tenu de ce graphique simple, il est facile de voir comment nous pouvons simuler des contrefactuels pour les prédictions des modèles d’apprentissage automatique : nous modifions simplement les valeurs des caractéristiques d’une instance avant de faire les prédictions et nous analysons comment la prédiction change. Nous nous intéressons aux scénarios dans lesquels la prédiction change de manière pertinente, comme un changement de classe prédite (par exemple, demande de crédit acceptée ou rejetée), ou dans lesquels la prédiction atteint un certain seuil (par exemple, la probabilité de cancer atteint <span class="math inline">\(10%\)</span>). <strong>Une explication contrefactuelle d’une prédiction décrit le plus petit changement apporté aux valeurs des caractéristiques qui transforme la prédiction en une sortie prédéfinie</strong>.</p>
<p>Il existe des méthodes d’explication contrefactuelles indépendantes du modèle et spécifiques au modèle, mais dans ce chapitre, nous nous concentrons sur les méthodes indépendantes du modèle qui fonctionnent uniquement avec les entrées et les sorties du modèle (et non avec la structure interne de modèles spécifiques). Ces méthodes trouveraient également leur place dans le <a href="../06-model_agnostic_methods/">chapitre indépendant du modèle</a>, puisque l’interprétation peut être exprimée comme un résumé des différences dans les valeurs des caractéristiques (« modifier les caractéristiques A et B pour modifier la prédiction »). Mais une explication contrefactuelle est elle-même une nouvelle instance, elle figure donc dans ce chapitre (« en partant de l’instance X, changez A et B pour obtenir une instance contrefactuelle »). Contrairement <a href="../08-global_model_agnostic_methods/08.7-prototype-criticisms.html">aux prototypes</a>, les contrefactuels ne doivent pas nécessairement être des instances réelles issues des données d’entraînement, mais peuvent être une nouvelle combinaison de valeurs de caractéristiques.</p>
<p>Avant d’expliquer comment créer des contrefactuels, j’aimerais discuter de quelques cas d’utilisation des contrefactuels et de ce à quoi ressemble une bonne explication contrefactuelle.</p>
<p>Dans ce premier exemple, Peter demande un prêt et est rejeté par le logiciel bancaire (propulsé par l’apprentissage automatique). Il se demande pourquoi sa demande a été rejetée et comment il pourrait améliorer ses chances d’obtenir un prêt. La question du « pourquoi » peut être formulée de manière contrefactuelle : quel est le plus petit changement dans les caractéristiques (revenu, nombre de cartes de crédit, âge, …) qui ferait passer la prédiction de rejetée à approuvée ? Une réponse possible pourrait être : si Pierre gagnait 10 000 de plus par an, il obtiendrait le prêt. Ou si Peter avait moins de cartes de crédit et n’avait pas fait défaut sur un prêt il y a cinq ans, il obtiendrait le prêt. Peter ne connaîtra jamais les raisons du refus, car la banque n’a aucun intérêt à la transparence, mais c’est une autre histoire.</p>
<p>Dans notre deuxième exemple, nous souhaitons expliquer un modèle qui prédit un résultat continu avec des explications contrefactuelles. Anna souhaite louer son appartement, mais elle ne sait pas exactement combien facturer. Elle décide donc de former un modèle d’apprentissage automatique pour prédire le loyer. Bien sûr, comme Anna est une data scientist, c’est ainsi qu’elle résout ses problèmes. Après avoir entré tous les détails concernant la taille, l’emplacement, si les animaux sont autorisés, etc., le mannequin lui dit qu’elle peut facturer 900 EUR. Elle s’attendait à 1 000 EUR ou plus, mais elle fait confiance à son modèle et décide de jouer avec les valeurs caractéristiques de l’appartement pour voir comment elle peut améliorer la valeur de l’appartement. Elle découvre que l’appartement pourrait être loué pour plus de 1 000 euros s’il était plus grand de <span class="math inline">\(15 m^2\)</span>. Une connaissance intéressante, mais non exploitable, car elle ne peut pas agrandir son appartement. Enfin, en modifiant uniquement les valeurs des caractéristiques sous son contrôle (cuisine intégrée oui/non, animaux admis oui/non, type de sol, etc.), elle découvre que si elle autorise les animaux et installe des fenêtres avec une meilleure isolation, elle peut facturer 1000 EUR. Anna a intuitivement travaillé avec des hypothèses contrefactuelles pour changer le résultat.</p>
<p>Les contrefactuels sont <a href="../03-interpretability/03.6-human_friendly_explanations.qmd">des explications conviviales</a>, car ils contrastent avec l’instance actuelle et parce qu’ils sont sélectifs, ce qui signifie qu’ils se concentrent généralement sur un petit nombre de changements de fonctionnalités. Mais les contrefactuels souffrent de « l’effet Rashomon ». Rashomon est un film japonais dans lequel le meurtre d’un samouraï est raconté par différentes personnes. Chacune des histoires explique également bien le résultat, mais les histoires se contredisent. La même chose peut également se produire avec les hypothèses contrefactuelles, car il existe généralement plusieurs explications contrefactuelles différentes. Chaque contrefactuel raconte une « histoire » différente sur la façon dont un certain résultat a été atteint. Un contrefactuel pourrait dire de changer la caractéristique A, l’autre contrefactuel pourrait dire de laisser A inchangé mais de changer la caractéristique B, ce qui est une contradiction. Cette question des vérités multiples peut être résolue soit en rapportant toutes les explications contrefactuelles, soit en ayant un critère pour évaluer les contrefactuelles et sélectionner la meilleure.</p>
<p>En parlant de critères, comment définir une bonne explication contrefactuelle ? Premièrement, l’utilisateur d’une explication contrefactuelle définit un changement pertinent dans la prédiction d’une instance (= la réalité alternative). Une première exigence évidente est qu’une <strong>instance contrefactuelle produise la prédiction prédéfinie aussi fidèlement que possible</strong>. Il n’est pas toujours possible de trouver un contrefactuel avec la prédiction prédéfinie. Par exemple, dans un paramètre de classification comportant deux classes, une classe rare et une classe fréquente, le modèle peut toujours classer une instance comme classe fréquente. Changer les valeurs des caractéristiques afin que l’étiquette prédite passe de la classe fréquente à la classe rare peut être impossible. Nous souhaitons donc assouplir l’exigence selon laquelle la prédiction du contrefactuel doit correspondre exactement au résultat prédéfini. Dans l’exemple de classification, nous pourrions rechercher un contrefactuel dans lequel la probabilité prédite de la classe rare est augmentée à <span class="math inline">\(10%\)</span> au lieu des <span class="math inline">\(2%\)</span> actuels. La question est alors de savoir quels sont les changements minimaux dans les caractéristiques pour que la probabilité prédite passe de <span class="math inline">\(2%\)</span> à <span class="math inline">\(10%\)</span> (ou près de <span class="math inline">\(10%\)</span>) ?</p>
<p>Un autre critère de qualité est qu’un <strong>contrefactuel doit être aussi similaire que possible à l’instance en ce qui concerne les valeurs des caractéristiques</strong>. La distance entre deux instances peut être mesurée, par exemple, avec la distance de Manhattan ou la distance de Gower si nous avons à la fois des caractéristiques discrètes et continues. Le contrefactuel ne doit pas seulement être proche de l’instance d’origine, mais doit également <strong>modifier le moins de caractéristiques possible</strong>. Pour mesurer la qualité d’une explication contrefactuelle dans cette métrique, nous pouvons simplement compter le nombre de caractéristiques modifiées ou, en termes mathématiques sophistiqués, mesurer la <span class="math inline">\(L_0\)</span> norme entre instance contrefactuelle et instance réelle.</p>
<p>Troisièmement, il est souvent souhaitable de générer <strong>de multiples explications contrefactuelles</strong> afin que le sujet de la décision ait accès à de multiples façons viables de générer un résultat différent. Par exemple, en poursuivant notre exemple de prêt, une explication contrefactuelle pourrait suggérer de doubler simplement le revenu pour obtenir un prêt, tandis qu’une autre explication contrefactuelle pourrait suggérer de déménager dans une ville voisine et d’augmenter légèrement le revenu pour obtenir un prêt. Il convient de noter que même si le premier scénario contrefactuel pourrait être possible pour certains, le second pourrait être plus exploitable pour d’autres. Ainsi, en plus de fournir au sujet de la décision différentes manières d’obtenir le résultat souhaité, la diversité permet également à des individus « divers » de modifier les caractéristiques qui leur conviennent.</p>
<p>La dernière exigence est qu’une <strong>instance contrefactuelle doit avoir des valeurs de caractéristiques probables</strong>. Cela n’aurait pas de sens de générer une explication contrefactuelle pour l’exemple du loyer où la taille d’un appartement est négative ou le nombre de pièces est fixé à 200. C’est encore mieux lorsque le contrefactuel est probable selon la distribution conjointe des données, par exemple, un appartement de 10 pièces et <span class="math inline">\(20 m^2\)</span> ne doit pas être considéré comme une explication contrefactuelle. Idéalement, si le nombre de mètres carrés augmente, il faudrait également proposer une augmentation du nombre de pièces.</p>
<section id="générer-des-explications-contrefactuelles" class="level3">
<h3 class="anchored" data-anchor-id="générer-des-explications-contrefactuelles">9.3.1 - Générer des explications contrefactuelles</h3>
<p>Une approche simple et naïve pour générer des explications contrefactuelles consiste à rechercher par essais et erreurs. Cette approche implique de modifier de manière aléatoire les valeurs des caractéristiques de l’instance d’intérêt et de s’arrêter lorsque le résultat souhaité est prédit. Comme l’exemple où Anna a essayé de trouver une version de son appartement pour laquelle elle pourrait facturer un loyer plus élevé. Mais il existe de meilleures approches que les essais et erreurs. Tout d’abord, nous définissons une fonction de perte basée sur les critères mentionnés ci-dessus. Cette perte prend en entrée l’instance d’intérêt, un contrefactuel et le résultat (contrefactuel) souhaité. Ensuite, nous pouvons trouver l’explication contrefactuelle qui minimise cette perte à l’aide d’un algorithme d’optimisation. De nombreuses méthodes procèdent de cette manière, mais diffèrent par leur définition de la fonction de perte et leur méthode d’optimisation.</p>
<p>Dans ce qui suit, nous nous concentrons sur deux d’entre eux : d’abord celui de Wachter et al.&nbsp;(2017)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, qui ont introduit l’explication contrefactuelle comme méthode d’interprétation et, deuxièmement, celle de Dandl et al.&nbsp;(2020)<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> qui prend en compte les quatre critères mentionnés ci-dessus.</p>
<section id="méthode-de-wachter-et-al." class="level4">
<h4 class="anchored" data-anchor-id="méthode-de-wachter-et-al.">9.3.1.1 - Méthode de Wachter et al.</h4>
<p>Wachter et coll. suggèrent de minimiser la perte suivante :</p>
<p><span class="math display">\[L(x,x^\prime,y^\prime,\lambda)=\lambda\cdot(\hat{f}(x^\prime)-y^\prime)^2+d(x,x^\prime)\]</span></p>
<p>Le premier terme est la distance quadratique entre la prédiction du modèle pour le contrefactuel <span class="math inline">\(x^\prime\)</span> et le résultat souhaité <span class="math inline">\(y^\prime\)</span>, que l’utilisateur doit définir à l’avance. Le deuxième terme est la distance d entre l’instance <span class="math inline">\(x\)</span> à expliquer et le contrefactuel <span class="math inline">\(x^\prime\)</span>. La perte mesure la distance entre le résultat prédit du contrefactuel et le résultat prédéfini et la distance entre le contrefactuel et l’instance d’intérêt. La fonction de distance d est définie comme la distance de Manhattan pondérée par l’écart médian absolu inverse (MAD) de chaque entité.</p>
<p><span class="math display">\[d(x,x^\prime)=\sum_{j=1}^p\frac{|x_j-x^\prime_j|}{MAD_j}\]</span></p>
<p>La distance totale est la somme de toutes les p distances selon les caractéristiques, c’est-à-dire les différences absolues des valeurs des caractéristiques entre l’instance x et le contrefactuel x’. Les distances par entité sont mises à l’échelle par l’inverse de l’écart absolu médian de l’entité j sur l’ensemble de données défini comme :</p>
<p><span class="math display">\[MAD_j=\text{median}_{i\in{}\{1,\ldots,n\}}(|x_{i,j}-\text{median}_{l\in{}\{1,\ldots,n\}}(x_{l,j})|)\]</span></p>
<p>La médiane d’un vecteur est la valeur à laquelle la moitié des valeurs du vecteur sont supérieures et l’autre moitié inférieure. Le MAD est l’équivalent de la variance d’une entité, mais au lieu d’utiliser la moyenne comme centre et de faire la somme sur les distances carrées, nous utilisons la médiane comme centre et de faire la somme sur les distances absolues. La fonction de distance proposée présente l’avantage par rapport à la distance euclidienne d’ être plus robuste aux valeurs aberrantes. La mise à l’échelle avec le MAD est nécessaire pour amener toutes les caractéristiques à la même échelle – peu importe que vous mesuriez la taille d’un appartement en mètres carrés ou en pieds carrés.</p>
<p>Le paramètre <span class="math inline">\(\lambda\)</span> équilibre la distance dans la prédiction (premier terme) par rapport à la distance dans les valeurs des caractéristiques (deuxième terme). La perte est résolue pour un temps donné <span class="math inline">\(\lambda\)</span> et renvoie un x’ contrefactuel. Une valeur plus élevée de <span class="math inline">\(\lambda\)</span> signifie que nous préférons les contrefactuels avec des prédictions proches du résultat souhaité y’, une valeur inférieure signifie que nous préférons les contrefactuels x’ qui sont très similaires à x dans les valeurs des caractéristiques. Si <span class="math inline">\(\lambda\)</span> est très grande, l’instance avec la prédiction la plus proche de y’ sera sélectionnée, quelle que soit sa distance par rapport à x. En fin de compte, l’utilisateur doit décider comment équilibrer l’exigence selon laquelle la prédiction du contrefactuel correspond au résultat souhaité avec l’exigence que le contrefactuel soit similaire à x. Les auteurs de la méthode suggèrent au lieu de sélectionner une valeur pour <span class="math inline">\(\lambda\)</span> pour sélectionner une tolérance <span class="math inline">\(\epsilon\)</span> à quelle distance de <span class="math inline">\(y^\prime\)</span> la prédiction de l’instance contrefactuelle est autorisée. Cette contrainte peut s’écrire :</p>
<p><span class="math display">\[|\hat{f}(x^\prime)-y^\prime|\leq\epsilon\]</span></p>
<p>Pour minimiser cette fonction de perte, tout algorithme d’optimisation approprié peut être utilisé, tel que Nelder-Mead. Si vous avez accès aux dégradés du modèle d’apprentissage automatique, vous pouvez utiliser des méthodes basées sur les dégradés comme ADAM. L’instance <span class="math inline">\(x\)</span> à expliquer, la sortie souhaitée <span class="math inline">\(y^\prime\)</span> et le paramètre de tolérance <span class="math inline">\(\epsilon\)</span> doit être réglé à l’avance. La fonction de perte est minimisée pour <span class="math inline">\(x^\prime\)</span> et le <span class="math inline">\(x^\prime\)</span> contrefactuel (localement) optimal est renvoyé tout en augmentant <span class="math inline">\(\lambda\)</span> jusqu’à ce qu’une solution suffisamment proche soit trouvée (= dans le paramètre de tolérance) :</p>
<p><span class="math display">\[\arg\min_{x^\prime}\max_{\lambda}L(x,x^\prime,y^\prime,\lambda).\]</span></p>
<p>Dans l’ensemble, la recette pour produire les contrefactuels est simple : 1. Sélectionnez une instance <span class="math inline">\(x\)</span> à expliquer, le résultat souhaité <span class="math inline">\(y^\prime\)</span>, une tolérance <span class="math inline">\(\epsilon\)</span> et une (faible) valeur initiale pour <span class="math inline">\(\lambda\)</span>. 2. Échantillonnez une instance aléatoire comme contrefactuel initial. 3. Optimisez la perte avec le contrefactuel initialement échantillonné comme point de départ. 4. Alors que <span class="math inline">\(|\hat{f}(x^\prime)-y^\prime|&gt;\epsilon\)</span>: - Augmenter <span class="math inline">\(\lambda\)</span>. - Optimisez la perte avec le contrefactuel actuel comme point de départ. - Renvoyez le contrefactuel qui minimise la perte. 5. Répétez les étapes 2 à 4 et renvoyez la liste des contrefactuels ou celle qui minimise la perte.</p>
<p>La méthode proposée présente certains inconvénients. Il <strong>ne prend en compte que le premier et le deuxième critères</strong>, pas les deux derniers (« produire des contrefactuels avec seulement quelques changements de caractéristiques et des valeurs de caractéristiques probables »). <span class="math inline">\(d\)</span> ne préfère pas les solutions clairsemées puisque l’augmentation de 10 entités par 1 donnera la même distance à <span class="math inline">\(x\)</span> que l’augmentation d’une entité par 10. Les combinaisons d’entités irréalistes ne sont pas pénalisées.</p>
<p>La méthode <strong>ne gère pas bien les caractéristiques catégorielles</strong> avec de nombreux niveaux différents. Les auteurs de la méthode ont suggéré d’exécuter la méthode séparément pour chaque combinaison de valeurs de caractéristiques des caractéristiques catégorielles, mais cela entraînera une explosion combinatoire si vous disposez de plusieurs caractéristiques catégorielles avec de nombreuses valeurs. Par exemple, six caractéristiques catégorielles avec dix niveaux uniques signifieraient un million d’exécutions.</p>
<p>Voyons maintenant une autre approche pour surmonter ces problèmes.</p>
</section>
<section id="méthode-de-dandl-et-al." class="level4">
<h4 class="anchored" data-anchor-id="méthode-de-dandl-et-al.">9.3.1.2 Méthode de Dandl et al.</h4>
<p>Dandler et coll. suggèrent de minimiser simultanément une perte de quatre objectifs : <span class="math display">\[L(x,x',y',X^{obs})=\big(o_1(\hat{f}(x'),y'),o_2(x, x'),o_3(x,x'),o_4(x',X^{obs})\big) \]</span></p>
<p>Chacun des quatre objectifs <span class="math inline">\(o_1\)</span> à <span class="math inline">\(o_4\)</span> correspond à l’un des quatre critères mentionnés ci-dessus. Le premier objectif <span class="math inline">\(o_1\)</span> reflète que la prédiction de notre contrefactuel <span class="math inline">\(x^\prime\)</span> doit être aussi proche que possible de notre prédiction souhaitée <span class="math inline">\(y^\prime\)</span>. Nous souhaitons donc minimiser la distance entre <span class="math inline">\(\hat{f}(x')\)</span> et <span class="math inline">\(y^\prime\)</span>, calculé ici par la métrique de Manhattan (norme <span class="math inline">\(L_1\)</span>):</p>
<p><span class="math display">\[o_1(\hat{f}(x'),y')=\begin{cases}0&amp;\text{if $\hat{f}(x')\in{}y'$}\\\inf\limits_{y'\in y'}|\hat{f}(x')-y'|&amp;\text{else}\end{cases}\]</span></p>
<p>Le deuxième objectif <span class="math inline">\(o_2\)</span> reflète que notre contrefactuel doit être aussi similaire que possible à notre exemple <span class="math inline">\(x\)</span>. Il quantifie la distance entre x’ et x comme la distance de Gower :</p>
<p><span class="math display">\[o_2(x,x')=\frac{1}{p}\sum_{j=1}^{p}\delta_G(x_j, x'_j)\]</span></p>
<p>avec <span class="math inline">\(p\)</span> étant le nombre de fonctionnalités. La valeur de <span class="math inline">\(\delta_G\)</span> dépend du type de fonctionnalité de <span class="math inline">\(x_j\)</span> :</p>
<p><span class="math display">\[\delta_G(x_j,x'_j)=\begin{cases}\frac{1}{\widehat{R}_j}|x_j-x'_j|&amp;\text{if $x_j$ numerical}\\\mathbb{I}_{x_j\neq{}x'_j}&amp;\text{if $x_j$ categorical}\end{cases}\]</span></p>
<p>Diviser la distance d’une entité numérique <span class="math inline">\(j\)</span> par <span class="math inline">\(\widehat{R}_j\)</span>, la plage de valeurs observées, les échelles <span class="math inline">\(\delta_G\)</span> pour toutes les fonctionnalités entre 0 et 1.</p>
<p>La distance de Gower peut gérer à la fois les caractéristiques numériques et catégorielles, mais ne prend pas en compte le nombre de caractéristiques modifiées. On compte donc le nombre de fonctionnalités dans un troisième objectif <span class="math inline">\(o_3\)</span> en utilisant la norme <span class="math inline">\(L_0\)</span> :</p>
<p><span class="math display">\[o_3(x, x^\prime) = \|x-x^\prime\|_0 = \sum_{j=1}^{p} \mathbb{I}_{x'_j \neq x_j}\]</span></p>
<p>En minimisant <span class="math inline">\(o_3\)</span> nous visons notre troisième critère – des changements de fonctionnalités clairsemés.</p>
<p>Le quatrième objectif <span class="math inline">\(o_4\)</span> reflète que nos contrefactuels devraient avoir des valeurs/combinaisons de caractéristiques probables. Nous pouvons déduire la « probabilité » qu’un point de données utilise les données d’entraînement ou un autre ensemble de données. Nous désignons cet ensemble de données par <span class="math inline">\(X^{obs}\)</span>. Comme approximation de la vraisemblance, <span class="math inline">\(o_4\)</span> mesure la distance moyenne de Gower entre x’ et le point de données observé le plus proche <span class="math inline">\(x^{[1]}\in{}X^{obs}\)</span>:</p>
<p><span class="math display">\[o_4(x',\textbf{X}^{obs})=\frac{1}{p}\sum_{j=1}^{p}\delta_G(x'_j,x^{[1]}_j)\]</span></p>
<p>Par rapport à Wachter et al., <span class="math inline">\(L(x,x',y',X^{obs})\)</span> n’a pas de termes d’équilibrage/pondération comme <span class="math inline">\(\lambda\)</span>. Nous ne voulons pas effondrer les quatre objectifs <span class="math inline">\(o_1\)</span>, <span class="math inline">\(o_2\)</span>, <span class="math inline">\(o_3\)</span> et <span class="math inline">\(o_4\)</span> en un seul objectif en les résumant et en les pondérant, mais nous souhaitons optimiser les quatre termes simultanément.</p>
<p>Comment peut-on faire ça? Nous utilisons l’ algorithme génétique de tri non dominé 55 ou NSGA-II abrégé. NSGA-II est un algorithme inspiré de la nature qui applique la loi de Darwin de la « survie du plus fort ». Nous désignons la fitness d’un contrefactuel par son vecteur de valeurs d’objectifs <span class="math inline">\((o_1,o_2,o_3,o_4)\)</span>. Plus les valeurs des objectifs d’un contrefactuel sont faibles, plus il est « adapté ».</p>
<p>L’algorithme se compose de quatre étapes qui sont répétées jusqu’à ce qu’un critère d’arrêt soit satisfait, par exemple un nombre maximum d’itérations/générations. La figure suivante visualise les quatre étapes d’une génération.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/cfexp-nsgaII.jpg" class="img-fluid figure-img" data-align="center"></p>
<figcaption>Visualisation d’une génération de l’algorithme NSGA-II.</figcaption>
</figure>
</div>
<p>Dans la première génération, un groupe de candidats contrefactuels est initialisé en modifiant aléatoirement certaines des caractéristiques par rapport à notre instance x à expliquer. En reprenant l’exemple de crédit ci-dessus, un contrefactuel pourrait suggérer d’augmenter le revenu de 30 000 € tandis qu’un autre propose de n’avoir aucun défaut au cours des cinq dernières années et une réduction de l’âge de dix ans. Toutes les autres valeurs de caractéristiques sont égales aux valeurs de x. Chaque candidat est ensuite évalué à l’aide des quatre fonctions objectives ci-dessus. Parmi eux, nous sélectionnons au hasard certains candidats, les candidats les plus en forme étant plus susceptibles d’être sélectionnés. Les candidats sont recombinés par paires pour produire des enfants qui leur ressemblent en faisant la moyenne de leurs valeurs de caractéristiques numériques ou en croisant leurs caractéristiques catégorielles. De plus, nous modifions légèrement les valeurs des fonctionnalités des enfants pour explorer tout l’espace des fonctionnalités.</p>
<p>Parmi les deux groupes résultants, un avec les parents et un avec les enfants, nous ne voulons que la meilleure moitié en utilisant deux algorithmes de tri. L’algorithme de tri non dominé trie les candidats selon leurs valeurs objectives. Si les candidats sont également bons, l’algorithme de tri par distance de foule trie les candidats en fonction de leur diversité.</p>
<p>Compte tenu du classement des deux algorithmes de tri, nous sélectionnons la moitié des candidats la plus prometteuse et/ou la plus diversifiée. Nous utilisons cet ensemble pour la prochaine génération et recommençons le processus de sélection, de recombinaison et de mutation. En répétant les étapes encore et encore, nous espérons approcher un ensemble diversifié de candidats prometteurs avec de faibles valeurs objectives. À partir de cet ensemble, nous pouvons choisir ceux dont nous sommes le plus satisfaits, ou nous pouvons donner un résumé de tous les scénarios contrefactuels en soulignant quelles caractéristiques ont été modifiées et à quelle fréquence.</p>
</section>
</section>
<section id="exemple" class="level3">
<h3 class="anchored" data-anchor-id="exemple">9.3.2 - Exemple</h3>
<p>L’exemple suivant est basé sur l’exemple d’ensemble de données sur le crédit de Dandl et al.&nbsp;(2020). L’ensemble de données allemand sur le risque de crédit est disponible sur la plateforme de défis d’apprentissage automatique <a href="https://www.kaggle.com/uciml/german-credit">kaggle.com</a>.</p>
<p>Les auteurs ont formé une machine à vecteurs de support (avec noyau à base radiale) pour prédire la probabilité qu’un client présente un bon risque de crédit. L’ensemble de données correspondant contient 522 observations complètes et neuf fonctionnalités contenant des informations sur le crédit et les clients.</p>
<p>L’objectif est de trouver des explications contrefactuelles pour un client avec les valeurs de caractéristiques suivantes :</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>age</th>
<th>sex</th>
<th>emploi</th>
<th>logement</th>
<th>épargne</th>
<th>montant</th>
<th>durée</th>
<th>but</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>58</td>
<td>f</td>
<td>non qualifié</td>
<td>gratuit</td>
<td>petit</td>
<td>6143</td>
<td>48</td>
<td>voiture</td>
</tr>
</tbody>
</table>
<p>Le SVM prédit que la femme présente un bon risque de crédit avec une probabilité de 24,2 %. Les hypothèses contrefactuelles devraient expliquer comment les caractéristiques d’entrée doivent être modifiées pour obtenir une probabilité prédite supérieure à 50 % ?</p>
<p>Le tableau suivant présente les dix meilleurs scénarios contrefactuels :</p>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 18%">
<col style="width: 11%">
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th>age</th>
<th>sex</th>
<th>emploi</th>
<th>montant</th>
<th>durée</th>
<th><span class="math inline">\(o_2\)</span></th>
<th><span class="math inline">\(o_3\)</span></th>
<th><span class="math inline">\(o_4\)</span></th>
<th><span class="math inline">\(\hat{f}(x')\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td>qualifié</td>
<td></td>
<td>-20</td>
<td>0.108</td>
<td>2</td>
<td>0.036</td>
<td>0.501</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>qualifié</td>
<td></td>
<td>-24</td>
<td>0.114</td>
<td>2</td>
<td>0.029</td>
<td>0.525</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td>qualifié</td>
<td></td>
<td>-22</td>
<td>0.111</td>
<td>2</td>
<td>0.033</td>
<td>0.513</td>
</tr>
<tr class="even">
<td>-6</td>
<td></td>
<td>qualifié</td>
<td></td>
<td>-24</td>
<td>0.126</td>
<td>3</td>
<td>0.018</td>
<td>0.505</td>
</tr>
<tr class="odd">
<td>-3</td>
<td></td>
<td>qualifié</td>
<td></td>
<td>-24</td>
<td>0.120</td>
<td>3</td>
<td>0.024</td>
<td>0.515</td>
</tr>
<tr class="even">
<td>-1</td>
<td></td>
<td>qualifié</td>
<td></td>
<td>-24</td>
<td>0.116</td>
<td>3</td>
<td>0.027</td>
<td>0.522</td>
</tr>
<tr class="odd">
<td>-3</td>
<td>m</td>
<td></td>
<td></td>
<td>-24</td>
<td>0.195</td>
<td>3</td>
<td>0.012</td>
<td>0.501</td>
</tr>
<tr class="even">
<td>-6</td>
<td>m</td>
<td></td>
<td></td>
<td>-25</td>
<td>0.202</td>
<td>3</td>
<td>0.011</td>
<td>0.501</td>
</tr>
<tr class="odd">
<td>-30</td>
<td>m</td>
<td>qualifié</td>
<td></td>
<td>-24</td>
<td>0.285</td>
<td>4</td>
<td>0.005</td>
<td>0.590</td>
</tr>
<tr class="even">
<td>-4</td>
<td>m</td>
<td></td>
<td>-1254</td>
<td>-24</td>
<td>0.204</td>
<td>4</td>
<td>0.002</td>
<td>0.506</td>
</tr>
</tbody>
</table>
<p>Les cinq premières colonnes contiennent les modifications de fonctionnalités proposées (seules les fonctionnalités modifiées sont affichées), les trois colonnes suivantes montrent les valeurs objectives (<span class="math inline">\(o_1\)</span> est égal à 0 dans tous les cas) et la dernière colonne affiche la probabilité prédite.</p>
<p>Tous les scénarios contrefactuels ont des probabilités prédites supérieures à <span class="math inline">\(50%\)</span> et ne se dominent pas. Non dominé signifie qu’aucun des scénarios contrefactuels n’a des valeurs plus petites dans tous les objectifs que les autres scénarios contrefactuels. Nous pouvons considérer nos scénarios contrefactuels comme un ensemble de solutions de compromis.</p>
<p>Ils suggèrent tous une réduction de la durée de 48 mois à un minimum de 23 mois, certains d’entre eux proposent que la femme devienne qualifiée plutôt que non qualifiée. Certains contrefactuels suggèrent même de changer le genre de femme à homme, ce qui montre un biais sexiste du modèle. Ce changement s’accompagne toujours d’une réduction de l’âge entre un et 30 ans. Nous pouvons également constater que, bien que certains contrefactuels suggèrent des modifications de quatre caractéristiques, ces contrefactuels sont ceux qui se rapprochent le plus des données de formation.</p>
</section>
<section id="avantages" class="level3">
<h3 class="anchored" data-anchor-id="avantages">9.3.3 - Avantages</h3>
<p><strong>L’interprétation des explications contrefactuelles est très claire</strong>. Si les valeurs des caractéristiques d’une instance sont modifiées en fonction du contrefactuel, la prédiction passe à la prédiction prédéfinie. Il n’y a aucune hypothèse supplémentaire ni aucune magie en arrière-plan. Cela signifie également qu’elle n’est pas aussi dangereuse que des méthodes comme <a href="../09-local_model_agnostic_methods/09.2-lime.html">LIME</a>, où il n’est pas clair dans quelle mesure nous pouvons extrapoler le modèle local pour l’interprétation.</p>
<p>La méthode contrefactuelle crée une nouvelle instance, mais nous pouvons également résumer une méthode contrefactuelle en signalant quelles valeurs de caractéristiques ont changé. Cela nous donne <strong>deux options pour rendre compte de nos résultats</strong>. Vous pouvez soit signaler l’instance contrefactuelle, soit mettre en évidence les caractéristiques qui ont été modifiées entre l’instance qui vous intéresse et l’instance contrefactuelle.</p>
<p>La <strong>méthode contrefactuelle ne nécessite pas d’accès aux données ou au modèle</strong>. Il suffit d’accéder à la fonction de prédiction du modèle, qui fonctionnerait également via une API web par exemple. Ceci est intéressant pour les entreprises qui sont auditées par des tiers ou qui proposent des explications aux utilisateurs sans divulguer le modèle ou les données. Une entreprise a intérêt à protéger son modèle et ses données, pour des raisons de secrets commerciaux ou de protection des données. Les explications contrefactuelles offrent un équilibre entre l’explication des prédictions du modèle et la protection des intérêts du propriétaire du modèle.</p>
<p>La méthode <strong>fonctionne également avec des systèmes qui n’utilisent pas l’apprentissage automatique</strong>. Nous pouvons créer des contrefactuels pour tout système qui reçoit des entrées et renvoie des sorties. Le système qui prédit les loyers des appartements pourrait également être constitué de règles manuscrites, et les explications contrefactuelles fonctionneraient toujours.</p>
<p><strong>La méthode d’explication contrefactuelle est relativement facile à mettre en oeuvre</strong>, puisqu’il s’agit essentiellement d’une fonction de perte (avec un ou plusieurs objectifs) qui peut être optimisée avec des bibliothèques d’optimiseurs standards. Certains détails supplémentaires doivent être pris en compte, tels que la limitation des valeurs des caractéristiques à des plages significatives (par exemple uniquement des tailles d’appartement positives).</p>
</section>
<section id="inconvénients" class="level3">
<h3 class="anchored" data-anchor-id="inconvénients">9.3.4 - Inconvénients</h3>
<p><strong>Pour chaque cas, vous trouverez généralement plusieurs explications contrefactuelles (effet Rashomon)</strong>. Ceci n’est pas pratique : la plupart des gens préfèrent les explications simples à la complexité du monde réel. C’est aussi un défi pratique. Disons que nous avons généré 23 explications contrefactuelles pour une instance. Les signalons-nous tous ? Seulement le meilleur? Et s’ils étaient tous relativement « bons », mais très différents ? Il faut répondre à ces questions à nouveau pour chaque projet. Il peut également être avantageux d’avoir plusieurs explications contrefactuelles, car les humains peuvent alors sélectionner celles qui correspondent à leurs connaissances antérieures.</p>
</section>
<section id="logiciels-et-alternatives" class="level3">
<h3 class="anchored" data-anchor-id="logiciels-et-alternatives">9.3.5 - Logiciels et alternatives</h3>
<p>La méthode d’explication contrefactuelle multi-objectif de Dandl et al.&nbsp;est implémenté dans un <a href="https://github.com/susanne-207/moc/tree/master/counterfactuals">référentiel GitHub</a>.</p>
<p>Dans le package Python, les auteurs <a href="https://github.com/SeldonIO/alibi">d’Alibi</a> ont implémenté une <a href="https://docs.seldon.io/projects/alibi/en/stable/methods/CF.html">méthode contrefactuelle simple</a> ainsi qu’une <a href="https://docs.seldon.io/projects/alibi/en/stable/methods/CFProto.htm">méthode étendue</a> qui utilise des prototypes de classe pour améliorer l’interprétabilité et la convergence des résultats de l’algorithme<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p>
<p>Karimi et coll. (2020)<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> ont également fourni une implémentation Python de leur algorithme MACE dans un <a href="https://github.com/amirhk/mace">référentiel GitHub</a>. Ils ont traduit les critères nécessaires pour des contrefactuels appropriés en formules logiques et utilisent des solveurs de satisfiabilité pour trouver des contrefactuels qui les satisfont.</p>
<p>Mothilal et coll. (2020)<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> ont développé <a href="https://github.com/interpretml/DiCE">DiCE (Diverse Counterfactual Explanation)</a> pour générer un ensemble diversifié d’explications contrefactuelles basées sur des processus ponctuels déterminants. DiCE implémente à la fois une méthode indépendante du modèle et une méthode basée sur le gradient.</p>
<p>Une autre façon de rechercher des contrefactuels est l’algorithme Growing Spheres de Laugel et al.&nbsp;(2017)<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>. Ils n’utilisent pas le mot contrefactuel dans leur article, mais la méthode est assez similaire. Ils définissent également une fonction de perte qui favorise les contrefactuels avec le moins de changements possible dans les valeurs des caractéristiques. Au lieu d’optimiser directement la fonction, ils suggèrent de dessiner d’abord une sphère autour du point d’intérêt, d’échantillonner des points à l’intérieur de cette sphère et de vérifier si l’un des points échantillonnés donne la prédiction souhaitée. Ensuite, ils contractent ou élargissent la sphère en conséquence jusqu’à ce qu’un contrefactuel (rare) soit trouvé et finalement renvoyé.</p>
<p>Ancres de Ribeiro et al.&nbsp;(2018)<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> sont à l’opposé des contrefactuels, voir le chapitre sur <a href="../09-local_model_agnostic_methods/09.4-anchors.html">les règles de portée (ancres)</a>.</p>
<!-- REFERENCES -->
<!-- 02 -->
<!-- 02.3 -->
<!-- 03 -->
<!-- 03.1 -->
<!--
[^Miller2017]: Miller, Tim. "Explanation in artificial intelligence: Insights from the social sciences." arXiv Preprint arXiv:1706.07269. (2017).
-->
<!-- 03.3 -->
<!-- 03.4 -->
<!--
[^Doshi2017]: Doshi-Velez, Finale, and Been Kim. "Towards a rigorous science of interpretable machine learning," no. Ml: 1–13. https://arxiv.org/abs/1702.08608 (2017).
-->
<!-- 03.5 -->
<!-- 03.6 -->
<!--
[^Miller2017]: Miller, Tim. "Explanation in artificial intelligence: Insights from the social sciences." arXiv Preprint arXiv:1706.07269. (2017).
-->
<!-- 04.1 -->
<!-- 04.2 -->
<!-- 04.3 -->
<!-- 05.1 -->
<!-- 05.4 -->
<!--
[^Hastie]: Friedman, Jerome, Trevor Hastie, and Robert Tibshirani. "The elements of statistical learning". hastie.su.domains/ElemStatLearn (2009).
-->
<!-- 05.5 -->
<!-- 05.6 -->
<!-- 06.0 -->
<!--
[^Ribeiro2016]: Ribeiro, Marco Tulio, Sameer Singh, and Carlos Guestrin. "Model-agnostic interpretability of machine learning." ICML Workshop on Human Interpretability in Machine Learning. (2016).
-->
<!-- 07.0 -->
<!-- 08.1 -->
<!-- 08.2 -->
<!-- 08.3 -->
<!--
[^Friedman2008]: Friedman, Jerome H, and Bogdan E Popescu. "Predictive learning via rule ensembles." The Annals of Applied Statistics. JSTOR, 916–54. (2008).
-->
<!--
[^pdp-importance]: Greenwell, Brandon M., Bradley C. Boehmke, and Andrew J. McCarthy. "A simple and effective model-based variable importance measure." arXiv preprint arXiv:1805.04755 (2018).
-->
<!-- 08.4 -->
<!--
[^fanova]: Hooker, Giles. "Discovering additive structure in black box functions." Proceedings of the tenth ACM SIGKDD international conference on Knowledge discovery and data mining. (2004).
-->
<!--
[^ale]: Apley, Daniel W., and Jingyu Zhu. "Visualizing the effects of predictor variables in black box supervised learning models." Journal of the Royal Statistical Society: Series B (Statistical Methodology) 82.4 (2020): 1059-1086.
-->
<!-- 08.5 -->
<!-- 08.7 -->
<!--
[^critique]: Kim, Been, Rajiv Khanna, and Oluwasanmi O. Koyejo. "Examples are not enough, learn to criticize! Criticism for interpretability." Advances in Neural Information Processing Systems (2016).
-->
<!-- 09.1 -->
<!-- 09.2 -->
<!-- 09.3 -->
<!-- 09.4 -->
<!-- 09.5 -->
<!-- 09.6 -->
<!--
[^lundberg2017]: Lundberg, Scott M., and Su-In Lee. "A unified approach to interpreting model predictions." Advances in Neural Information Processing Systems (2017).
-->
<!--
[^cond1]: Sundararajan, Mukund, and Amir Najmi. "The many Shapley values for model explanation." arXiv preprint arXiv:1908.08474 (2019).
-->
<!--
[^cond2]: Janzing, Dominik, Lenon Minorics, and Patrick Blöbaum. "Feature relevance quantification in explainable AI: A causal problem." International Conference on Artificial Intelligence and Statistics. PMLR (2020).
-->
<!--
[^fool]: Slack, Dylan, Sophie Hilgard, Emily Jia, Sameer Singh, and Himabindu Lakkaraju. "Fooling lime and shap: Adversarial attacks on post hoc explanation methods." In Proceedings of the AAAI/ACM Conference on AI, Ethics, and Society, pp. 180-186 (2020).
-->
<!-- 10.0 -->
<!-- 10.1 -->
<!-- 10.2 -->
<!--
[^integrated-gradients]: Sundararajan, Mukund, Ankur Taly, and Qiqi Yan. "Axiomatic attribution for deep networks." Proceedings of the 34th International Conference on Machine Learning-Volume 70. JMLR. org, 2017.
-->
<!--
[^grad-cam]: Selvaraju, Ramprasaath R., et al. "Grad-cam: Visual explanations from deep networks via gradient-based localization." Proceedings of the IEEE international conference on computer vision. (2017).
-->
<!--
[^guided-backpropagation]: Springenberg, Jost Tobias, et al. "Striving for simplicity: The all convolutional net." arXiv preprint arXiv:1412.6806 (2014).
-->
<!--
[^lrp]: Bach, Sebastian, et al. "On pixel-wise explanations for non-linear classifier decisions by layer-wise relevance propagation." PloS one 10.7 (2015).
-->
<!-- References about problems -->
<!--
[^better-understanding]: Ancona, Marco, et al. "Towards better understanding of gradient-based attribution methods for deep neural networks." arXiv preprint arXiv:1711.06104 (2017).
-->
<!--
[^perplexing-behavior]: Nie, Weili, Yang Zhang, and Ankit Patel. "A theoretical explanation for perplexing behaviors of backpropagation-based visualizations." arXiv preprint arXiv:1805.07039 (2018).
-->
<!-- Toolboxes -->
<!--
[^innvestigate]: Alber, Maximilian, Sebastian Lapuschkin, Philipp Seegerer, Miriam Hägele, Kristof T. Schütt, Grégoire Montavon, Wojciech Samek, Klaus-Robert Müller, Sven Dähne, and Pieter-Jan Kindermans. "iNNvestigate neural networks!." J. Mach. Learn. Res. 20, no. 93 (2019): 1-8.
-->
<!--
[^human-visuals]: Linsley, Drew, et al. "What are the visual features underlying human versus machine vision?." Proceedings of the IEEE International Conference on Computer Vision Workshops. 2017.
-->
<!-- 10.3 -->
<!-- 10.4 -->
<!-- 10.5 -->


</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Retour au sommet</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Notes de bas de page</h2>

<ol>
<li id="fn1"><p>Wachter, Sandra, Brent Mittelstadt, and Chris Russell. “Counterfactual explanations without opening the black box: Automated decisions and the GDPR.” (2017).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Dandl, Susanne, Christoph Molnar, Martin Binder, Bernd Bischl. “Multi-objective counterfactual explanations”. In: Bäck T. et al.&nbsp;(eds) Parallel Problem Solving from Nature – PPSN XVI. PPSN 2020. Lecture Notes in Computer Science, vol 12269. Springer, Cham (2020).<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Van Looveren, Arnaud, and Janis Klaise. “Interpretable counterfactual explanations guided by prototypes.” arXiv preprint arXiv:1907.02584 (2019).<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Karimi, Amir-Hossein, Gilles Barthe, Borja Balle and Isabel Valera. “Model-agnostic counterfactual explanations for consequential decisions.” AISTATS (2020).<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Mothilal, Ramaravind K., Amit Sharma, and Chenhao Tan. “Explaining machine learning classifiers through diverse counterfactual explanations.” Proceedings of the 2020 Conference on Fairness, Accountability, and Transparency. (2020).<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Laugel, Thibault, Marie-Jeanne Lesot, Christophe Marsala, Xavier Renard, and Marcin Detyniecki. “Inverse classification for comparison-based interpretability in machine learning.” arXiv preprint arXiv:1712.08443 (2017).<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Ribeiro, Marco Tulio, Sameer Singh, and Carlos Guestrin. “Anchors: High-precision model-agnostic explanations.” AAAI Conference on Artificial Intelligence (2018).<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../09-local_model_agnostic_methods/09.2-lime.html" class="pagination-link" aria-label="9.2 - Substitut local (LIME)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">9.2 - Substitut local (LIME)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../09-local_model_agnostic_methods/09.4-anchors.html" class="pagination-link" aria-label="9.4 - Règles de portée (ancres)">
        <span class="nav-page-text">9.4 - Règles de portée (ancres)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2018-2025, Christoph Molnar <br> Traduction 2024-2025 : Nicolas Guillard</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>